#include <stdio.h>
#include "sys/alt_timestamp.h"
#include "sys/alt_cache.h"
#include "system.h"
#include "nios2.h"

#define HAL_PLATFORM_RESET() NIOS2_WRITE_STATUS(0); NIOS2_WRITE_IENABLE(0); ((void (*) (void)) NIOS2_RESET_ADDR) ()

void vecsum(int *sum, short *in1, short *in2, int N)
{
   int i;
   for (i = 0; i < N; i++)
      sum[i] = in1[i] + in2[i];
}


int main(void){

    short a[1050] = {-1184, -1046, -7139, -2656, -8471, 11548, -13660, -4124, 12223, -13356, -10033, 527, 512, -2330, 11982, -1629, -3919, 8372, 5711, -6948, -994, 13459, -10872, 5805, -5708, -6228, -9649, 7590, -847, 3230, -8940, 8879, -9009, 5734, -6732, 7552, 2547, -4302, -2889, 13592, 3247, -334, 7655, 11346, 384, -13724, -6731, 8516, 14457, 9393, 8892, -5623, 1271, -6626, -8504, -1641, 4950, 3144, -8095, -5898, -9042, 14178, 7922, 3414, 5435, -12194, -13865, -2668, 5820, -10560, -6999, -14152, -6010, -2791, 10983, -6348, 6252, 4526, 5348, -9637, 2471, -3262, 10373, -4234, 10163, -11472, 4242, -7816, 9438, -7155, -3421, 6060, 12733, 9984, 110, -5062, 382, -1946, -5769, -13377, -3855, -7724, 10499, 4997, 3038, 8707, 9381, -2969, -13125, 4223, 13384, -65, 4482, -13260, 2287, -6843, -1018, 5885, -11749, 12582, -14478, 4035, -8493, 513, -6352, -10112, 11757, 1099, -14496, 10986, -11575, -4522, -7413, -13923, -2906, -3435, 2765, -1804, -11044, -5827, 5167, 820, 3316, 1263, -3954, 2887, 5325, 10334, -6, -2094, 7439, 11764, 5010, 10177, -10320, -11749, 4354, -6447, -10736, -2026, 5876, 8035, 1728, -4621, 7115, 14448, 4101, -13298, -1466, -11040, -4146, 10111, 5244, 6586, -975, 14062, 9462, 3994, 6032, 5249, 6705, 2477, 10149, 4887, -12121, 14325, 1214, -4612, -7312, 6074, 9597, -10887, 7836, -7103, 10074, 117, -9567, 4508, -4394, -13796, 4325, -2393, -3336, -6236, 7904, -4201, 11801, 7777, -1023, -1338, -5143, -6712, -2301, 12324, 12648, 640, 10440, 3559, 7706, 6979, -14026, 13417, -4739, -12264, 6049, -13686, 3805, 11094, -11255, 9826, 2066, 10229, -12812, -1871, -5143, -13713, 4201, -4682, 12552, -5349, 11752, -9435, -7518, 14406, 1380, 196, -2112, 7623, -14635, 12121, -6594, 9331, 9276, 13852, -8775, 362, -9093, -12972, 2730, 13269, 4895, -12601, -9566, -5869, 5968, 1510, 10710, 9468, -9288, 8781, 4005, -9363, -10177, 8850, -11238, -13616, 4547, -1761, 10868, 12120, -527, 2115, -8968, 11465, -9565, 14054, -3168, 11895, -11377, 8791, -6162, 1176, 1527, 11766, 7582, -9378, 378, -14261, 11102, -3904, 6374, -14362, 3554, 183, -14680, -2627, 857, 5180, -14285, -5034, 259, -14135, -5769, 13597, -9254, 5785, 1460, -5319, -9476, 13314, 12221, -3934, -14191, -2661, 14560, -3971, 7889, 955, -11085, -5013, 5358, 14157, 37, -12456, -1603, -3637, 9006, -1070, 32, 11071, -5961, -11931, 4690, -5374, 12010, 10766, 10696, 8725, -9874, 13790, 14306, 4563, 1969, -5144, 2279, 11182, -11698, -2034, -8418, -3618, 6188, 5851, 1566, -6373, 8591, -308, -7380, 1585, -13952, 14035, 14327, 6207, -14393, -7190, -2801, -10026, 5311, -438, 10260, 11337, 14328, -706, 9000, 12524, 13132, 3809, 14326, -3803, -6836, -13307, 8415, -12212, -2484, -11200, 12242, -10234, 3528, 5893, -6901, -1175, -6161, -12994, -13464, 10460, 13866, -886, -210, 13831, 12266, -7522, -1626, -9534, -13878, -7387, 3307, -8044, -8870, -9740, -425, 10623, 4867, 6628, 11241, 2799, -105, 9730, 14238, -11509, 3454, 8764, 4553, 6325, -7288, -811, 10720, -2945, 3973, 4560, -7821, 5579, -3483, 3511, 3350, 10136, 10807, 4011, -718, -5541, -12921, 6082, -9589, -669, -7442, -9252, -5788, 161, -11763, -14470, 3891, -5149, -6352, 4618, 9052, -3005, -10557, 11675, -6615, -11201, -2194, -9407, 2897, -8268, 3527, 11924, 6535, 7099, 9679, 10414, -1341, -4388, 13790, 8609, -6539, 11255, -4320, 8388, -10910, -10526, 12169, -10386, 3889, 2432, 797, 4373, 1955, -7492, -9342, 12149, -1876, 5348, 7802, 6026, -13495, -10021, -3742, -4371, -4220, -11732, 4604, 11311, -10167, -2011, -7984, 13927, 8796, 14299, -110, -11498, 3863, -12838, -6357, 14136, -12871, 6847, 4295, -12428, 2720, 3280, 13007, 9495, -11321, 4761, 11313, 3809, 8086, 10751, 11411, -11184, -262, 11616, 14607, -5002, 11919, -13917, 7039, 4074, -4146, 9625, -12564, -9238, -11087, 5161, 13810, -970, -601, -3118, -7458, -11197, 10940, 8460, -4631, 655, 5004, 5932, 32, 8858, 7201, 8069, -13670, -12528, -13204, 2028, 1530, 7734, 6395, -3519, 163, 10172, 11007, 12070, 11089, 7743, -9528, 13305, 4190, 2514, 5897, 5587, 5183, 6798, 11679, 13147, 10533, -2166, 11869, 12570, 13264, -1011, 7854, -11694, -2442, 4590, 8591, 2370, 7447, -14648, -338, 6111, -5778, -254, 11936, -14381, 11186, -8701, -622, -14328, -13839, -13897, 176, -12911, -748, -1424, 2708, 9896, -12692, -10503, 10792, 2141, 11950, 8956, -11875, 8151, -7762, 8228, 8813, 13719, -3622, 10107, 5600, -11530, 1883, 14161, 701, -11926, -14314, 13692, -2797, -8759, 5462, -10764, 1130, -9, -7415, 7514, -11294, -8839, -8921, -13324, -8328, -1655, -5395, 5512, 14699, 411, 6722, -5819, 14373, -12686, 12495, -14625, 7595, 10289, -14043, 8798, 5513, -1627, 3227, 14356, -1095, 3745, -4893, -7524, -9318, 2316, 1492, -13143, 5472, -9306, 4227, 9300, -6613, 5158, -7308, -11661, -11978, 6465, 6779, 8818, 6396, 8290, 5677, -9083, 3878, 9496, 1954, 7240, -8311, 13099, -1835, 3748, 3389, 11084, -13149, 11173, 8373, 10934, 442, -7349, -1373, 10964, -9821, -2884, 13896, 7477, 4743, -5101, -14272, -483, 11577, 6061, -4909, -8222, 273, -11664, -10713, 11047, 5580, -1916, -14277, -12050, 7906, 2484, -7160, -1565, -903, 6172, -13477, 13779, 6865, 12181, 7141, 10242, 4075, -10026, 10078, -4526, -8796, -662, 7608, -12184, -413, -13580, -8558, -9107, 11060, -8331, -10912, -14626, -822, 204, -12248, -202, 1046, -1088, -7215, 1534, 6190, -5999, -4725, -14673, -5339, 10142, 1620, 2911, 11207, -4086, 11174, 6974, -6457, -7172, 12385, 13290, -77, 4750, -9420, -320, -5494, 2576, -7048, 10159, 13134, -8034, 1558, -18, 9025, -7996, 4539, 2894, 14098, 3576, -10428, -11584, -5961, -5074, -7228, 9859, -11100, 11032, -378, -2428, 6137, -5924, 7732, -3721, 7817, -11105, -12085, -12280, 666, -8800, -1254, 223, 14336, 9992, 10377, -10841, 4029, -12468, -6043, -13854, -1532, -4901, -1050, 4462, -4741, 9025, 2702, -2277, 13536, -5274, 4384, -8459, -369, -9214, -3232, -7528, -13495, 1872, -3647, 14323, 5483, -11601, -8633, -9745, 13098, -8999, -12198, -886, 3421, 917, 9658, -2537, 13087, 14394, -1949, 4931, -10466, 3424, -14660, 12197, -14655, -11049, 963, -10723, -12203, -152, -4146, 10025, -10100, -14277, -14195, -10435, 12261, -3394, 8443, -11267, 6651, 7652, 11707, -1698, -6535, 8307, 7762, 12349, -2676, 2923, 13931, 3086, 1181, 7134, -10295, -4573, 7684, -3284, 5553, -13678, -11698, -5992, -11232, -733, -5170, 8501, -3949, -5937, 13220, 14597, 10011, -14689, -6003, -6335, -13577, 9534, 2699, -10286, 9819, -9848, 3219, -10650, 2652, -6627, 8913, 13571, -6396, -7169, 8413, 7858, -8208, 2557, 5908, 13471, -8242, 9665, -140, 1961, -4532, -2665, 2696, -13828, 5223, -7655, 12266, 11384, 3520, -2397, -2307, -3008, -12671, 6080, 14324, 11234, -10704, 9832, 5932, -12940, -5920, 8453, -11579, 4452, -11414, -6980, -9055, 13306, 8202, -11333, -2673, 10406, -1159, 13259, -1386, -1903, -6966, -10785, -9761, 3206, -6598, -8418, -1902, -278, 1060, 7612, 11696, 1042, 12376, -572, -8195, 2713, 7041, 12114, -2671, 6796, -324, 14270, 3865, 12101, 11838, -9471, -10612, 13557, -12514, -318, -8706, -2425, -12385, -1714, 13770, -7993, 482, 12424, -3220, 10089, -9503, -10485, -9580, -13999, 14260, -8173, -4381, 2194, 128, -7761, 11885, -10857, 8611, -10498, -14728, -7235, -6555, 1969, 8591, 6522};
    short b[1050] = {-867, 14256, -4412, 9276, 7500, 8921, 703, -1367, 10990, 7146, 7989, -2700, -10112, 1144, -9900, 9136, -5673, 8295, -14624, 11693, -4206, 14113, -9646, -7876, 6239, 7978, -565, 13196, -8623, -12295, 1841, 2604, -10125, 12020, 12484, 3399, 8130, -11232, -11765, 12650, 3999, 3238, 10321, -1823, 6974, 8658, -569, 5983, 12339, -4914, 11434, -10516, -10194, 11584, 13928, 3215, -5035, -2302, -9628, -10088, -3308, 9445, 3043, -3497, -998, 11611, -9840, 4943, 7448, 1160, 13748, 13973, -12597, 7691, 3307, 13463, 3437, 11309, -6987, -958, 7752, 183, -1474, 14239, 10954, -2167, 10119, 2352, -4827, 140, -3399, -8804, 7506, 2281, -10704, 13822, 5056, 13645, 1709, -5221, -7662, 4458, -10614, 6634, 585, 4678, 14639, -9102, -10314, -8007, -6496, -8392, 12573, 14165, -11079, 8982, 11566, 3287, 6002, 989, 2281, -1631, -1839, 1937, 9029, 3769, -12260, -370, -6558, 4061, -10969, -1224, -10328, 5653, 1959, -3685, 11151, -11222, -10087, 1518, 5340, 11501, -8603, 8992, 7874, -6284, -13505, 5912, -13963, -7982, -8458, -12183, 9056, 11545, -12547, 7501, 6262, 6348, 4567, -11819, -4269, 14570, -6649, -11612, 3617, 4785, -5900, 5868, 12230, 5653, 7888, 8412, 2833, 2522, -8069, 5454, 4865, -10567, -4467, -585, 14008, 9164, 7677, -13017, -13290, 13842, 3398, -3514, -6012, -8105, -2464, -5398, -7488, 7526, -5759, 9242, 13921, 11888, 8102, -9353, 6519, 11090, -6391, -11941, -8768, 12463, -7750, -5662, 8089, 1987, 10187, 2435, 14504, -11059, 1487, -11410, 7372, -11455, 7748, -3251, 6111, 9278, -3360, 6159, 4500, -632, 4621, 12372, -337, -6859, 10435, -2954, 8924, 11855, -13445, 2357, 3504, 6598, 6543, 14087, -157, -539, 6750, 9331, -12423, 1254, -7437, 232, -12, 3706, -1824, -5167, 9434, -1738, 4498, 12529, 10070, -11127, -1966, 889, -11326, 11657, -8004, 13429, 4261, 13818, -10198, -5155, 2683, 13290, 8565, -877, 5353, 8917, -12435, -3519, -7224, -1582, -11586, 3917, -12243, 5569, 14339, -13593, -10722, -3666, 4086, -8900, -12546, 12737, 12289, -5609, -6790, 8113, -4194, -4783, 10756, -10774, -13687, 12187, 4267, 3724, 6391, 4070, 11019, -7649, 2080, 11091, -4510, 6280, 12666, -11199, -9272, -8731, 13286, 11314, 9607, 5046, -8963, -12347, -4074, 4563, -13056, -9611, 4340, -14579, 6499, -13164, 4233, 10407, 6879, -5480, 8250, -5474, -14623, 9395, -3273, 945, -8733, 4054, -7543, 4893, -2076, -13064, -5614, -7324, -6582, 13793, -12734, 7738, 2020, 14643, 2923, -10750, 14561, 12836, -8963, -13031, 8989, 1482, 1422, -2758, 9544, 720, 11243, -10225, 7909, -7738, 13565, -3487, 11911, -5001, -4434, -1318, 2497, 4675, -258, 4205, 2171, 14445, 10554, -1516, 9624, -13056, 2915, 9709, 1341, -2221, 1986, 8316, -7853, 6563, -7828, 1865, 10434, -2032, -7505, 12123, -14338, -3117, 5877, 8542, -6414, 12181, -4728, 14350, 9727, 2668, 14729, 3260, -7340, -1546, 9455, -6049, -9078, 6883, -7935, 4967, 7425, 3987, 13848, 3583, -5698, 1668, -9725, -3569, -13346, -11524, 5592, 2695, -8046, -8561, 6143, 14426, 4038, -3223, 5930, 3467, -13332, -2065, -5502, -14064, 6379, -10305, -3506, -1024, 12582, 6815, -1917, -14075, 1296, 9235, 13580, -13807, 8349, -881, -11905, 8464, 2796, 3070, 12643, 704, 13997, 158, -8711, -12170, -6255, 6642, 3351, 9931, -2733, -1308, -3579, -4318, 10298, 5250, 6650, 13836, -5264, 3439, -8853, -9837, 14741, 6258, 3847, 2420, -1367, -1421, -8320, 8435, 14009, -2857, -1790, -9893, 12782, 2751, -7688, 13886, 7112, 6331, -11927, 3022, -11173, 519, -9336, 13042, -2425, 2949, -11575, 7445, 5587, 2452, -11810, -9763, 9408, 2048, 9180, 3459, 190, -7281, -901, 473, -488, 7225, -13251, -3942, 9068, -1582, 10075, -2837, -12526, -6298, -2847, 8501, 3395, 11817, -1318, 11306, -2480, -12518, 848, -6667, -2683, 7146, -10570, 9852, -8271, 12725, -1375, 6838, -2517, -13781, -459, -14268, 365, 7097, -619, -10775, -10831, 10704, 14083, -1080, 10440, -3814, 4392, 6371, 14159, 10857, 1836, -10529, -9055, 13134, -4271, 13577, -12538, 5980, -8900, -8146, 1627, -11804, -12805, 6824, 12864, 11794, -4610, -3602, -3718, 3791, -13017, -13708, 13008, -1938, 890, -729, -9374, 7423, -6774, 10531, -62, 14257, -122, 3935, 3197, 921, -13489, -4838, -4745, 7121, -5767, -9475, -6328, -7097, 5017, -3622, 12465, -14287, 3793, 5761, -2910, 4900, -4963, 11967, -1219, -14007, 12976, 4187, 9784, 2763, -1585, 13784, -9, 2842, -14577, 11040, 217, 6307, 12600, 13286, -767, -12599, 5851, 890, 7943, -7221, -3749, 9017, 4124, 11254, 1794, -2830, 10643, -4503, -5204, -2140, 13538, 97, -7084, 826, 11692, 4123, 13777, 2962, -964, -171, 5980, -11045, 4319, 3426, -11091, -10107, -8330, 6164, 13771, 14511, 14155, -11819, -812, 13225, 6053, 2784, 3954, -1593, 7513, 8837, 10972, -9446, 4506, -13519, 13394, -12745, 753, 8275, -11954, 8695, -11685, -13119, 7020, 3135, -210, -9586, -5320, -11770, -10030, -14160, -10170, 4597, -11197, -2765, 12318, -2721, 1069, 14353, 187, -6384, -12078, -3691, 391, 11538, 8470, -7275, 1649, 5165, 7159, 1728, 2266, 4823, 10522, -14663, 2240, 7350, -1212, -3607, -3832, -12635, 10045, -1415, -4477, -1560, 892, 7059, -13831, 1057, 8063, -12310, -10277, 6047, -9060, 10325, -6726, 10492, 9259, 482, -9766, -9564, -14578, -5796, -4292, -10119, 4252, -12718, 10042, -5123, 14315, -10924, 13589, -284, 3672, -4596, -1854, -10440, 4907, -7309, 10045, -7074, 13269, -7171, 12856, -11112, -2441, 9719, 9986, -2728, 9150, 11249, -14051, -8968, 3826, -12826, 8449, 5422, -4300, 5150, -12191, 2335, 8649, 14624, -1146, 9982, 13131, 384, -292, 778, 2586, 4574, -5822, -9277, 1282, 6487, -9031, 8429, -5004, 12698, 264, -3246, -14091, 13797, -6271, -9547, 206, -12241, 12574, 12041, 9740, 8823, 655, -10882, -11690, 1856, -14254, -9409, -8275, -10259, 11601, -13878, -2085, 1769, -6591, 3904, -7223, 4151, -13963, -12265, 2236, 13902, -877, -11792, 6645, -2244, 1144, 3003, 8329, 10345, -6044, 1225, -3993, 813, -14040, -2691, 6101, -13036, -1226, 717, -5392, 4453, 13127, -2471, -9979, 13737, -12951, -13027, -9800, -7128, -7983, 3663, 3536, -4494, 10542, 5642, -2455, -5911, -13279, -2197, -12659, 4728, -9404, 11005, -3880, 10426, 11178, 5220, -14633, -12709, 4657, -4023, 1642, -6029, -11566, -14723, 13032, -2578, -6321, -2724, 12284, -5400, -13774, 2696, -9860, 6673, -140, 920, -13365, 2139, 3673, -1897, -1399, 7091, -6565, -6867, -10355, 8307, -8031, 10293, -9654, 9076, 9004, -6073, -10536, -2679, 12640, -7414, -1756, -8668, -4706, -3128, -11581, -5908, -12359, -3779, -8556, -5988, 8415, -3785, -5700, 6141, 13597, -14468, 6019, 8953, -3458, -5031, 4363, -6062, 1691, -4608, -5043, 7782, -14109, 5653, -13497, 7365, -502, -12753, -5783, -1178, 10737, -8345, -14398, 3741, -7493, -11194, -6624, -1882, -8134, -8238, 7136, -3541, -12658, -9358, 9111, 1299, -4911, 8191, -13392, 9402, -5236, 12182, -14074, -1368, -865, -14145, 13529, 5679, 7288, 10796, -4271, -8752, -13688, 2729, 8849, -2610, 11474, 12930, -3849, 4480, 8382, -6005, -598, 7613, 3342, 7106, 9846, -3607, -12600, -3041, 8328, -454, -13989, 12204, 3697, -10490, 5796, 11118, 7690, -3422, 3784, -1735, -10822, 5042, -1666, -7564, -13629, 6748, -13998, 12299, -12168, 3967, -2550, -10306, 7255, -4694, -7369, 12260, -4580, -14265, -1671, -1743, -14071, 7655, 2070, 1208};
    int sum[1050];

    if (alt_timestamp_start() < 0)
    {
      printf ("No timestamp device is available.\n");
    }

    alt_icache_flush_all();
    alt_dcache_flush_all();

    alt_u32 checksum_start_time = alt_timestamp();

    vecsum(&sum, a, b, 1050);

    alt_u32 checksum_end_time = alt_timestamp();
    alt_u32 i = checksum_end_time - checksum_start_time;

    printf("%ld\n", i);

    HAL_PLATFORM_RESET();

    }

